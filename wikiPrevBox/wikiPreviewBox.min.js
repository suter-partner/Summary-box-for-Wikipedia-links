/*!
 * WIKIPEDIA PREVIEW BOXES
 * su-pa.net (c) version 12/10/2021, 1.0.0, nick, MIT-License
 * https://su-pa.net/wikiPrevBox/ :: project page
 */
"use strict";{document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="/wikiPrevBox/wikiPreviewBox.min.css">'),document.body.insertAdjacentHTML("afterbegin",'<article id="wikiPreviewBox" class="wikiPreviewBox"></article>');let showNoImages=!1,wikiBoxWidth=300,textDirection=document.dir||"";void 0!==document.currentScript.dataset.wikipreview&&(showNoImages=!!document.currentScript.dataset.wikipreview.includes("noimages"),wikiBoxWidth=Math.min(Math.max(parseInt(document.currentScript.dataset.wikipreview.replace(/\D/g,"")||300),200),400));let wikiBoxMaxLenght=280,whatArticle="",wikiArticleUrl="",wikiLang="",wikiTermPos,wikiTerm,wikiPreviewBox=document.getElementById("wikiPreviewBox");wikiPreviewBox.style.width=wikiBoxWidth+"px",wikiPreviewBox.addEventListener("click",hideWikiBox),wikiPreviewBox.addEventListener("mouseover",showWikiBox),wikiPreviewBox.addEventListener("mouseout",hideWikiBox);let allWikiLinks=document.querySelectorAll("[href*='wikipedia.org']:not([href*='#nopreview'])"),allWithNopreview=document.querySelectorAll("[href*='#nopreview']");for(let z=0;z<allWithNopreview.length;z++)allWithNopreview[z].href=allWithNopreview[z].href.replace("#nopreview","");for(let i=0;i<allWikiLinks.length;i++)allWikiLinks[i].classList.add("wikiLink"),"rtl"===textDirection&&allWikiLinks[i].classList.add("wikiLink_rtl"),allWikiLinks[i].addEventListener("mouseover",e=>{wikiTerm=e.currentTarget,wikiArticleUrl=wikiTerm.href,whatArticle=""+wikiArticleUrl.split("/").pop(),wikiLang=wikiArticleUrl.split(".")[0].split("//")[1],wikiTermPos=wikiTerm.getBoundingClientRect();let wikiBoxLeft=wikiTermPos.left-wikiBoxWidth/2+(wikiTermPos.right-wikiTermPos.left)/2;wikiBoxLeft<0&&(wikiBoxLeft=10);let winInnerWidth=window.innerWidth;winInnerWidth<wikiBoxWidth?wikiBoxLeft=winInnerWidth-wikiBoxWidth+(wikiBoxWidth-winInnerWidth):wikiBoxLeft+wikiBoxWidth>winInnerWidth&&(wikiBoxLeft=winInnerWidth-wikiBoxWidth-20),wikiPreviewBox.style.left=wikiBoxLeft+"px",getWikiPreviewData(whatArticle,wikiLang)},!1),allWikiLinks[i].addEventListener("click",event=>{event.preventDefault()}),allWikiLinks[i].addEventListener("mouseout",hideWikiBox);function getWikiPreviewData(whatArticle,whatLang="en"){let showThisImgAnyway=(whatArticle=(whatArticle.charAt(0).toUpperCase()+whatArticle.slice(1)).replace(/ /g,"_")).includes("#showimage");showThisImgAnyway&&(whatArticle=whatArticle.replace("#showimage",""));let arrArticleSummary=[];navigator.onLine&&fetch("https://"+whatLang+".m.wikipedia.org/api/rest_v1/page/summary/"+whatArticle).then(response=>{response.status>=200&&response.status<=299&&response.json().then(wikiSummData=>{arrArticleSummary=wikiSummData.hasOwnProperty("thumbnail")&&!showNoImages||showThisImgAnyway?["<img height='"+wikiSummData.thumbnail.height+"' src='"+wikiSummData.thumbnail.source+"'/>",wikiSummData.extract_html,"https://"+whatLang+".wikipedia.org/wiki/"+whatArticle,wikiSummData.title]:["",wikiSummData.extract_html,"https://"+whatLang+".wikipedia.org/wiki/"+whatArticle,wikiSummData.title],createWikiBox(arrArticleSummary,wikiSummData.dir)})})}function createWikiBox(arrArticleSum,textDirection){let wikiBoxContent="";if(wikiBoxContent=arrArticleSum[0],arrArticleSum[1].length<=wikiBoxMaxLenght)wikiBoxContent+=arrArticleSum[1],"."==wikiBoxContent.slice(-1)&&(wikiBoxContent=wikiBoxContent.substring(0,wikiBoxContent.length-1));else{let lastClosingTag=arrArticleSum[1].substr(arrArticleSum[1].lastIndexOf("<"),arrArticleSum[1].length);wikiBoxContent+="</p>"===lastClosingTag?arrArticleSum[1].substring(0,wikiBoxMaxLenght-3):arrArticleSum[1].substring(0,wikiBoxMaxLenght-9),"."==wikiBoxContent.slice(-1)&&(wikiBoxContent=wikiBoxContent.substring(0,wikiBoxContent.length-1)),wikiBoxContent+="&nbsp;..."+lastClosingTag}wikiPreviewBox.innerHTML=wikiBoxContent;let wikiBoxfooter="<span class='wikiBoxfooter_"+textDirection+"'><a href='"+arrArticleSum[2]+"' target='_blank' rel='noopener'>"+arrArticleSum[3]+"</a> (wikipedia.org)</span><a href='https://su-pa.net/wikiPrevBox/' target='_blank' rel='noopener' title='about Wikipedia preview box - click for info' alt='about Wikipedia preview box - click for info'><span class='wikiBoxLogo-w_"+textDirection+"'>W</span></a>";wikiPreviewBox.insertAdjacentHTML("beforeend",wikiBoxfooter),wikiPreviewBox.getElementsByTagName("P")[0].setAttribute("lang",wikiLang),wikiPreviewBox.getElementsByTagName("P")[0].setAttribute("dir",textDirection),showWikiBox()}function showWikiBox(){let wikiPreviewBoxHeight=wikiPreviewBox.getBoundingClientRect().height||400,wikiTermPosBottom=wikiTermPos.bottom,visibleHeight=window.innerHeight;wikiTermPosBottom<wikiPreviewBoxHeight?(wikiPreviewBox.style.top=wikiTermPosBottom+window.scrollY+"px",wikiTermPosBottom+wikiPreviewBoxHeight>visibleHeight&&(wikiPreviewBox.style.top=window.scrollY+"px")):wikiPreviewBox.style.top=wikiTermPos.top+window.scrollY-wikiPreviewBox.getBoundingClientRect().height+"px",wikiPreviewBox.style.opacity=1,wikiPreviewBox.style.visibility="visible"}function hideWikiBox(){wikiTerm.matches(":hover")||(wikiPreviewBox.style.opacity=0,wikiPreviewBox.style.visibility="hidden")}}